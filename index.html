<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","version":"8.7.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta property="og:type" content="website">
<meta property="og:title" content="Huahui">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Huahui">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="huahui">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Huahui</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Huahui</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">huahui</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">37</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/08/vim-vim%E5%AF%84%E5%AD%98%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="huahui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Huahui">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/08/vim-vim%E5%AF%84%E5%AD%98%E5%99%A8/" class="post-title-link" itemprop="url">Vim 寄存器</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-07-08 22:33:51 / Modified: 22:35:44" itemprop="dateCreated datePublished" datetime="2022-07-08T22:33:51+08:00">2022-07-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/vim%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7/" itemprop="url" rel="index"><span itemprop="name">vim实用技巧</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="VIM寄存器"><a href="#VIM寄存器" class="headerlink" title="VIM寄存器"></a>VIM寄存器</h1><p>VIM有两个地方可以保存临时数据</p>
<pre><code>OS级别-剪切板
VIM级别-寄存器
</code></pre>
<p>VIM寄存器概述</p>
<p>寄存器是VIM用于保存临时数据的地方，不同于传统的编辑器（于系统共享一个寄存器，也成为剪切板），VIM具有多个寄存器，分别保存不同的临时数据，活用多个寄存器可以显著提高数据的安全和可操作性。<br>同时，为了与系统剪切板互通，VIM有一个专用的寄存器，与系统剪切板内容一致，既保证了VIM本身的统一性，也实现了与操作系统的对接。<br>查看寄存器值</p>
<pre><code>查看所有寄存器值：:reg
查看指定寄存器值：:reg &quot;&#123;register_name&#125;
</code></pre>
<p>调取寄存器值</p>
<pre><code>NORMAL Mode：&quot;&#123;register_name&#125;
COMMAND MODE：&lt;C-r&gt;+&quot;寄存器名称 （输入&lt;C-r&gt;后VIM会自动打出&quot;寄存器引用符号。
INSERT MODE：&lt;C-r&gt;+寄存器名称（无需输入寄存器引用符号&quot;）
</code></pre>
<p>VIM寄存器分类</p>
<ol>
<li>无名寄存器（默认寄存器）</li>
</ol>
<p>引用方式： <code>&quot;&quot;</code><br>该寄存器是默认的寄存器，所有的复制和修改操作（x、s、d、c、y）都会将该数据复制到无名寄存器。</p>
<ol start="2">
<li>字母寄存器</li>
</ol>
<p>引用方式：<code>&quot;a - &quot;z 或&quot;A - &quot;Z</code><br>{register_name}只能是一位的26个英文字母，从a-z。<br>大写字母A-Z寄存器内容将会合并到对应小写字母内容后边。</p>
<ol start="3">
<li>数字寄存器</li>
</ol>
<p>引用方式：<code>&quot;0 （数字0）- &quot;9</code></p>
<p>3.1 复制专用寄存器 0</p>
<p>引用方式：<code>&quot;0</code> （数字0）<br>仅当使用复制操作(y)时，该数据将会同时被复制到无名寄存器和复制专用寄存器。</p>
<p>3.2 逐级临时缓存寄存器1-9**</p>
<p>引用方式：”1 - “9 （数字1-9）<br>所有不带范围（‘(’，‘)’，‘{’，‘}’）、操作涉及1行以上的删除修改操作（x、s、d、c）的数据都会复制到逐级临时缓存寄存器，并在新的数据加入时，逐级先后推移。1的数据复制到2，2的复制到3，最后的9寄存器内容将会被删除。</p>
<pre><code>1行以内的数据删除修改操作的数据不会复制到逐级临时缓存寄存器1-9，而是复制到另一个Small Delete Register: &quot;-
</code></pre>
<ol start="4">
<li>黑洞寄存器</li>
</ol>
<p>引用方式：<code>&quot;_</code><br>几乎所有的操作涉及的数据都会被复制到寄存器，如果想让操作的数据不经过寄存器，可以指定黑洞寄存器，数据到该寄存器就会消失掉，不能显示，也不存在。</p>
<ol start="5">
<li>系统剪切板</li>
</ol>
<p>引用方式：<code>&quot;+ 或&quot;*</code><br>于VIM外部的GUI交互数据时，需要使用专用的系统剪切板。<br>在Unix环境下，”+寄存器需要+xterm-clipboard feature的VIM软件才能使用，具有这个feature的VIM可以安装vim-gtk（包含gvim和vim），使用gvim可以正常调用”+寄存器。</p>
<p>“+和”*的區別：</p>
<pre><code>    Under Windows, the * and + registers are equivalent.
    For X11 systems, though, they differ. For X11 systems, * is the selection, and + is the cut buffer (like clipboard).
        Text selected, or otherwise highlighted in one X11 app is available in the selection buffer.
        Text explicitly copied or cut is available in the cut buffer.
</code></pre>
<p>Ref:</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://vim.fandom.com/wiki/Accessing_the_system_clipboard">Accessing the system clipboard</a></li>
<li><a target="_blank" rel="noopener" href="http://vimcasts.org/blog/2013/11/getting-vim-with-clipboard-support/">Getting Vim with +clipboard support</a></li>
</ol>
<p>5.1 剪切板与自动缩进indent</p>
<p>如果开启了set autoindent，在粘贴具有格式缩进的文本时（如python程序），粘贴的结果将会是缩进混乱的，因为set autoindent的影响。<br>解决这个问题有两个方法：</p>
<ol>
<li><p>使用 <code>set paste</code> 模式<br> 开启paste模式后，autoindent等缩进功能将会被屏蔽，粘贴格式就会不受影响。<br> 每次手工开启关闭paste模式将会比较麻烦，可以在_vimrc中为其设置一个快捷键，每次需要时按一下即可切换：set pastetoggle=<f12></p>
</li>
<li><p>使用普通模式的 <code>&quot;+p </code>命令</p>
</li>
<li><p>插入模式输入 <code>&lt;C-r&gt;&lt;C-p&gt;&quot;+</code></p>
</li>
<li><p>表达式寄存器</p>
</li>
</ol>
<p>引用方式：”=<br>所有寄存器里最特殊的一个，用于计算表达式。<br>输入完该寄存器应用后，会在命令行里提示“=”，按需输入表达式，结果将会显示到光标处。<br>7. 其他寄存器</p>
<p>“% 当前文件名，包含文件路径。<br>“/ 上次查找的内容。<br>“. 上次插入的内容。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/08/hexo-hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="huahui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Huahui">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/08/hexo-hexo/" class="post-title-link" itemprop="url">Hexo</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-07-08 22:15:01 / Modified: 22:33:56" itemprop="dateCreated datePublished" datetime="2022-07-08T22:15:01+08:00">2022-07-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/hexo/" itemprop="url" rel="index"><span itemprop="name">hexo</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="HEXO"><a href="#HEXO" class="headerlink" title="HEXO"></a>HEXO</h1><h2 id="创建新博客"><a href="#创建新博客" class="headerlink" title="创建新博客"></a>创建新博客</h2><p>new指令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new post -p 后端/test.md </span><br></pre></td></tr></table></figure>

<p>执行后，会在 <code>_posts</code>文件夹下创建子文件夹 “后端”，并创建一篇test.md博文。</p>
<h2 id="创建关联文件夹"><a href="#创建关联文件夹" class="headerlink" title="创建关联文件夹"></a>创建关联文件夹</h2><p><code>_config.yml</code> 配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">post_asset_folder: true</span><br></pre></td></tr></table></figure>

<h2 id="网页生成"><a href="#网页生成" class="headerlink" title="网页生成"></a>网页生成</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo generate --&gt; hexo g</span><br><span class="line"></span><br><span class="line">hexo g -d #生成并部署</span><br></pre></td></tr></table></figure>

<h2 id="网页预览"><a href="#网页预览" class="headerlink" title="网页预览"></a>网页预览</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server --&gt; hexo s  #启动服务预览</span><br></pre></td></tr></table></figure>

<h2 id="网页部署"><a href="#网页部署" class="headerlink" title="网页部署"></a>网页部署</h2><p>hexo deploy –&gt; hexo d #部署</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/03/16/video-yuv-format/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="huahui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Huahui">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/03/16/video-yuv-format/" class="post-title-link" itemprop="url">YUV FORMAT</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-03-16 22:26:06" itemprop="dateCreated datePublished" datetime="2022-03-16T22:26:06+08:00">2022-03-16</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-03-17 01:02:54" itemprop="dateModified" datetime="2022-03-17T01:02:54+08:00">2022-03-17</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/yuv/" itemprop="url" rel="index"><span itemprop="name">yuv</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="YUV简介"><a href="#YUV简介" class="headerlink" title="YUV简介"></a>YUV简介</h1><p>YUV是一种颜色编码方法，它和我们熟知的RGB红绿蓝颜色体系相对应，它们之间能通过公式相互转换。YUV将亮度信息（Y）与色彩信息（UV）分离，没有UV信息一样可以显示完整的图像，只不过是黑白的。</p>
<p>YUV将亮度Y和色差UV三个信号分别进行编码，用同一信道发送出去。YUV不像RGB那样要求三个独立的视频信号同时传输，所以用YUV方式传送占用极少的频宽。</p>
<p>YUV 三个字母的意义分别为：</p>
<ul>
<li>Y：亮度，就是灰度值。除了表示亮度信号外，还含有较多的绿色通道量。单纯的 Y 分量可以显示出完整的黑白图像。</li>
<li>U：蓝色通道与亮度的差值。</li>
<li>V：红色通道与亮度的差值。</li>
</ul>
<p>其中，U、V 分量分别表示蓝 (blue)、红 (red) 分量信号，只含有色度信息，所以 YUV 也称为 YCbCr，其中，Cb、Cr的含义等同于U、V，C 可以理解为 component 或者 color。</p>
<table>
<thead>
<tr>
<th><img src="/2022/03/16/video-yuv-format/NO1_1.JPG"></th>
<th><img src="/2022/03/16/video-yuv-format/NO1.JPG"></th>
</tr>
</thead>
<tbody><tr>
<td><img src="/2022/03/16/video-yuv-format/NO1_3.JPG"></td>
<td><img src="/2022/03/16/video-yuv-format/NO1_4.PNG"></td>
</tr>
</tbody></table>
<p>第一幅是Y分量描述黑白图像，第二幅是U(V)分量描述，第三幅是V(U)分量描述，第四幅是YUV三幅合成后得到的正常图像</p>
<p>人眼对亮度的敏感超过色度，即使把色度信息减少一点，人眼也无法查觉这一点。如果一张图片使用YUV格式保存将更少地占用存储空间。</p>
<blockquote>
<p>以采集视频为例，RGB24格式一帧的大小size＝width×heigth×3 Bit，RGB32的size＝width×heigth×4，如果是I420（即YUV标准格式4：2：0）的数据量是 size＝width×heigth×1.5 Bit</p>
</blockquote>
<h1 id="YUV详解"><a href="#YUV详解" class="headerlink" title="YUV详解"></a>YUV详解</h1><h2 id="YUV的存储格式"><a href="#YUV的存储格式" class="headerlink" title="YUV的存储格式"></a>YUV的存储格式</h2><p>YUV的存储格式有两大类：planar和packed。</p>
<ul>
<li><p>对于planar的YUV格式，先连续存储所有像素点的Y，紧接着存储所有像素点的U，随后是所有像素点的V。</p>
</li>
<li><p>对于packed的YUV格式，每个像素点的Y,U,V是连续交替存储的。</p>
</li>
</ul>
<h2 id="YUV的采样方式"><a href="#YUV的采样方式" class="headerlink" title="YUV的采样方式"></a>YUV的采样方式</h2><p>YUV采样方式，主要描述像素Y、U、V分量采样比例，即表达每个像素时，Y、U、V分量的数目，通常有三种方式：YUV4:4:4，YUV4:2:2，YUV4:2:0。</p>
<ul>
<li><p>YUV4:4:4采样，每一个Y对应一组UV分量。</p>
</li>
<li><p>YUV4:2:2采样，每两个Y共用一组UV分量。</p>
</li>
<li><p>YUV4:2:0采样，每四个Y共用一组UV分量。</p>
</li>
</ul>
<p>用图直观地表示采集的方式，以黑点表示采样该像点的Y分量，以空心圆圈表示采用该像素点的UV分量<br><img src="/2022/03/16/video-yuv-format/NO2.png"></p>
<ul>
<li><p>使用YUV4:4:4采样，一共要进行12次采样分别4个Y，4个U，4个V，对每一个Y,U,V每个需要8个比特位,就需要12*8=96位，平均下每个像素点需要96/4=24位比特位表示。</p>
</li>
<li><p>使用YUV4:2:2采样,就需要8*8 =64位，平均每个像素64/4=16位。</p>
</li>
<li><p>使用YUV4:2:0采样,就需要6*8 =48位，平均每个像素48/4=12位。</p>
</li>
</ul>
<h2 id="常见的YUV码流的存储方式"><a href="#常见的YUV码流的存储方式" class="headerlink" title="常见的YUV码流的存储方式"></a>常见的YUV码流的存储方式</h2><p>Cb、Cr的含义等同于U、V</p>
<p>YUVY 采用422采样格式，packed存储格式<br><img src="/2022/03/16/video-yuv-format/NO3.png"></p>
<p>YUVY 采用422采样格式，Planar存储格式<br><img src="/2022/03/16/video-yuv-format/NO4.png"></p>
<h2 id="YUV420"><a href="#YUV420" class="headerlink" title="YUV420"></a>YUV420</h2><h3 id="YUV420P-和-YUV420SP"><a href="#YUV420P-和-YUV420SP" class="headerlink" title="YUV420P 和 YUV420SP"></a>YUV420P 和 YUV420SP</h3><ul>
<li>YUV420p：又叫planer平面模式，Y ，U，V分别再不同平面，也就是有三个平面。</li>
<li>YUV420sp：又叫bi-planer或two-planer双平面，Y一个平面，UV在同一个平面交叉存储。<br><img src="/2022/03/16/video-yuv-format/NO5.png"></li>
</ul>
<p>YUV420P –&gt; YUV420SP<br><img src="/2022/03/16/video-yuv-format/NO6.PNG"></p>
<h3 id="NV12-和-NV21"><a href="#NV12-和-NV21" class="headerlink" title="NV12 和 NV21"></a>NV12 和 NV21</h3><ul>
<li>NV12:IOS只有这一种模式。存储顺序是先存Y，再UV交替存储。YYYYUVUVUV</li>
<li>NV21:安卓的模式。存储顺序是先存Y，再存U，再VU交替存储。YYYYVUVUVU</li>
</ul>
<p>NV12: UV交替<br><img src="/2022/03/16/video-yuv-format/NO7.jpg"></p>
<p>NV21:  VU交替</p>
<h3 id="YUV420的内存计算"><a href="#YUV420的内存计算" class="headerlink" title="YUV420的内存计算"></a>YUV420的内存计算</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Y = width * hight </span><br><span class="line"></span><br><span class="line">U = Y / 4   V = Y / 4</span><br><span class="line"></span><br><span class="line">U + V = Y/2</span><br></pre></td></tr></table></figure>

<p>YUV420中</p>
<ul>
<li>V的步长（也就是宽）是Y的步长的一半，V的行高也是Y的一半。</li>
<li>U的步长和行高与V相同，也就是都是Y的一半。</li>
<li>U 和 V 的内存占用为都Y的 1/4, <code>U + V</code> 的内存占用为 Y 的 1/2</li>
</ul>
<p>所以YUV420 数据在内存中的长度是 width * hight * 3 / 2 = width * hight * 1.5 </p>
<p>以720×488大小图象YUV420 planar为例，</p>
<p>其存储格式是： 共大小为720 × 480× 3 × 1.5字节，</p>
<p>分为三个部分:Y,U和V</p>
<ul>
<li><p>Y分量：    (720×480)个字节</p>
</li>
<li><p>U(Cb)分量：(720×480 × 1/4)个字节</p>
</li>
<li><p>V(Cr)分量：(720×480 × 1/4)个字节</p>
</li>
</ul>
<p>三个部分内部均是行优先存储，三个部分之间是Y,U,V 顺序存储。</p>
<p>即YUV数据</p>
<ul>
<li><p>0－－720×480字节是Y分量值，</p>
</li>
<li><p>720×480－－720×480×5/4字节是U分量</p>
</li>
<li><p>720×480×5/4 －－720×480×3/2字节是V分量。</p>
</li>
</ul>
<h2 id="YUV422"><a href="#YUV422" class="headerlink" title="YUV422"></a>YUV422</h2><p>每两个Y共用一组UV分量。<strong>U/V的步长（也就是宽）是Y的步长的一半，但高与 Y 相同</strong>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Y = width * hight </span><br><span class="line"></span><br><span class="line">U = Y / 2   V = Y / 2</span><br><span class="line"></span><br><span class="line">Y = U + V</span><br></pre></td></tr></table></figure>

<h3 id="NV16-和-NV61"><a href="#NV16-和-NV61" class="headerlink" title="NV16 和 NV61"></a>NV16 和 NV61</h3><ul>
<li><p>NV16: UV 交替</p>
</li>
<li><p>NV61: VU 交替</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">NV16：</span><br><span class="line">                    w</span><br><span class="line">            +--------------------+</span><br><span class="line">            |Y0Y1Y2Y3...         |</span><br><span class="line">            |...                 |   h</span><br><span class="line">            |...                 |</span><br><span class="line">            |                    |</span><br><span class="line">            +--------------------+        UV 交替为NV16，VU 交替为NV61</span><br><span class="line">            |U0V0U1V1            |</span><br><span class="line">            |...                 |   h</span><br><span class="line">            |...                 |</span><br><span class="line">            |                    |</span><br><span class="line">            +--------------------+</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="YUV420与YUV422"><a href="#YUV420与YUV422" class="headerlink" title="YUV420与YUV422"></a>YUV420与YUV422</h2><p>UV分量的长都是 Y的一般，仅有宽不同， 420 UV的宽是Y的 1/2， 422 UV的宽与 Y 相同</p>
<h2 id="YUV400"><a href="#YUV400" class="headerlink" title="YUV400"></a>YUV400</h2><p>灰度数据，没有色度数据, <strong>即仅有 Y 分量</strong></p>
<h2 id="YUV常用格式附录"><a href="#YUV常用格式附录" class="headerlink" title="YUV常用格式附录"></a>YUV常用格式附录</h2><table>
<thead>
<tr>
<th>格式</th>
<th>Mode</th>
<th>通道</th>
<th>比特</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>GRAY</td>
<td>Planar</td>
<td>1</td>
<td>8</td>
<td>400. Y0Y1…Y15</td>
</tr>
<tr>
<td>I420</td>
<td>Planar</td>
<td>3</td>
<td>12</td>
<td>420. Y0Y1..Y15  U0U1U2U3 V0V1V2V3   * 常用 理解为YU12</td>
</tr>
<tr>
<td>IYUV</td>
<td>Planar</td>
<td>3</td>
<td>12</td>
<td>同I420</td>
</tr>
<tr>
<td>YUV420P</td>
<td>Planar</td>
<td>3</td>
<td>12</td>
<td>同I420 * 感觉 YUV420P 名字更常用</td>
</tr>
<tr>
<td>YUVJ420P</td>
<td>Planar</td>
<td>3</td>
<td>12</td>
<td>同I420,不同的是色彩转换公式，YUVJ使用  JPEG 公式， 输出数据范围[0..255]， I420的范围是 [16-240]</td>
</tr>
<tr>
<td>YV12</td>
<td>Planar</td>
<td>3</td>
<td>12</td>
<td>420. Y0Y1..Y15  V0V1V2V3 U0U1U2U3   * 常用 很多编解码器都用这个格式输入输出</td>
</tr>
<tr>
<td>YVU420P</td>
<td>Planar</td>
<td>3</td>
<td>12</td>
<td>同YV12</td>
</tr>
<tr>
<td>NV12</td>
<td>Planar</td>
<td>2</td>
<td>12</td>
<td>420. Y0Y1..Y15  U0V0U1V1…..U3V3 *常用</td>
</tr>
<tr>
<td>NV21</td>
<td>Planar</td>
<td>2</td>
<td>12</td>
<td>420. Y0Y1..Y15  V0U0V1U1…..V3U3</td>
</tr>
<tr>
<td>YV16</td>
<td>Planar</td>
<td>3</td>
<td>16</td>
<td>422. Y0Y1..Y15  V0V1..V7 U0U1..U7</td>
</tr>
<tr>
<td>YUV422P</td>
<td>Planar</td>
<td>3</td>
<td>16</td>
<td>同YV16 * 感觉 YUV422P 名字更常用</td>
</tr>
<tr>
<td>I422</td>
<td>Planar</td>
<td>3</td>
<td>16</td>
<td>同YV16</td>
</tr>
<tr>
<td>UYVY</td>
<td>Packed</td>
<td>1</td>
<td>16</td>
<td>422. U0Y0V0Y1</td>
</tr>
<tr>
<td>Y422</td>
<td>Packed</td>
<td>1</td>
<td>16</td>
<td>同UYVY</td>
</tr>
<tr>
<td>YUY2</td>
<td>Packed</td>
<td>1</td>
<td>16</td>
<td>422. Y0U0Y1V0</td>
</tr>
<tr>
<td>YUV422</td>
<td>Packed</td>
<td>1</td>
<td>16</td>
<td>同YUY2</td>
</tr>
<tr>
<td>YUYV</td>
<td>Packed</td>
<td>1</td>
<td>16</td>
<td>同YUY2</td>
</tr>
<tr>
<td>YVYU</td>
<td>Packed</td>
<td>1</td>
<td>16</td>
<td>422. Y0V0Y1U0</td>
</tr>
<tr>
<td>YU16</td>
<td>Planar</td>
<td>3</td>
<td>16</td>
<td>422. Y0Y1..Y15 U0U1..U7 V0V1..V7</td>
</tr>
<tr>
<td>NV16</td>
<td>Planar</td>
<td>2</td>
<td>16</td>
<td>422. Y0Y1..Y15  U0V0U1V1..U7V7</td>
</tr>
<tr>
<td>YV24</td>
<td>Planar</td>
<td>3</td>
<td>24</td>
<td>444. Y0Y1..Y15  V0V1..V15 U0U1..U15</td>
</tr>
<tr>
<td>I444</td>
<td>Planar</td>
<td>3</td>
<td>24</td>
<td>同YV24</td>
</tr>
<tr>
<td>IYU2</td>
<td>Packed</td>
<td>1</td>
<td>24</td>
<td>444. U0Y0V0</td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/03/16/tags/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="huahui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Huahui">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/03/16/tags/" class="post-title-link" itemprop="url">GTAGS</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-03-16 21:30:03 / Modified: 22:04:41" itemprop="dateCreated datePublished" datetime="2022-03-16T21:30:03+08:00">2022-03-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="使用Gtags辅助查看kernel源码"><a href="#使用Gtags辅助查看kernel源码" class="headerlink" title="使用Gtags辅助查看kernel源码"></a>使用Gtags辅助查看kernel源码</h1><p>使用<code>make gtags</code>在kernel根目录下生成索引文件。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gtags       - Generate GNU GLOBAL index</span><br></pre></td></tr></table></figure>
<p>kernel已对该命令进行封装，不必手动生成索引文件。在生成索引文件时还可以指定架构，这可以有效减少干扰项。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make gtags ARCH=arm</span><br><span class="line">make gtags ARCH=riscv</span><br></pre></td></tr></table></figure>

<p>kernel根目录下会生成三个新文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ls G*</span></span><br><span class="line">GPATH	GRTAGS	GTAGS</span><br></pre></td></tr></table></figure>

<h1 id="gtags-vim"><a href="#gtags-vim" class="headerlink" title="gtags.vim"></a>gtags.vim</h1><p>General form of Gtags command is as follows:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:Gtags [option] pattern</span><br></pre></td></tr></table></figure>
<p>To go to ‘func’, you can say</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:Gtags func</span><br></pre></td></tr></table></figure>
<p>Input completion is available. If you forgot the name of a function but recall only some characters of the head, please input them and press <TAB> key.</TAB></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:Gtags fu&lt;TAB&gt;</span><br><span class="line">:Gtags func			&lt;- Vim will append &#x27;nc&#x27;.</span><br></pre></td></tr></table></figure>

<p>To go to the referenced point of ‘func’, add <code>-r</code> option.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:Gtags -r func</span><br></pre></td></tr></table></figure>
<p>To go to any symbols which are not defined in GTAGS, try this.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:Gtags -s func</span><br></pre></td></tr></table></figure>
<p>To go to any string other than symbol, try this.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:Gtags -g ^[sg]et_</span><br></pre></td></tr></table></figure>
<p>This command accomplishes the same function as grep(1) but is more convenient because it retrieves an entire directory structure.</p>
<p>To get list of objects in a file ‘main.c’, use -f command.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:Gtags -f main.c</span><br></pre></td></tr></table></figure>
<p>If you are editing main.c itself, you can use ‘%’ instead.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:Gtags -f %</span><br></pre></td></tr></table></figure>
<p>You can get a list of files whose path include specified pattern.<br>For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   :Gtags -P /vm/			&lt;- all files under &#x27;vm&#x27; directory.</span><br><span class="line">   :Gtags -P \.h$			&lt;- all include files.</span><br><span class="line">:Gtags -P init			&lt;- all paths includes &#x27;init&#x27;</span><br></pre></td></tr></table></figure>
<p>If you omitted an argument and input only <ENTER> key to the prompt, vim shows list of all files in the project.</ENTER></p>
<p>Since all short options are sent to global(1) as is, you can  use the -i, -o, -O, and so on.</p>
<p>For example, if you want to ignore case distinctions in pattern.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:Gtags -gi paTtern</span><br></pre></td></tr></table></figure>
<p>It will match to both of ‘PATTERN’ and ‘pattern’.</p>
<p>If you want to search a pattern which starts with a hyphen like ‘-C’<br> then you can use the -e option like grep(1).</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:Gtags -ge -C</span><br></pre></td></tr></table></figure>
<p>By default, Gtags command search only in source files. If you want to<br>search in both source files and text files, or only in text files then</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:Gtags -go pattern		# both source and text</span><br><span class="line">:Gtags -gO pattern		# only text file</span><br></pre></td></tr></table></figure>

<h1 id="gtags-cscope"><a href="#gtags-cscope" class="headerlink" title="gtags-cscope"></a>gtags-cscope</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Find symbol		:cs find 0 or s</span><br><span class="line">Find definition		:cs find 1 or g</span><br><span class="line">Find functions called by this function	:cs find 2 or d</span><br><span class="line">Find reference		:cs find 3 or c</span><br><span class="line">Find text string	:cs find 4 or t</span><br><span class="line">Find egrep pattern	:cs find 6 or e</span><br><span class="line">Find path		:cs find 7 or f</span><br><span class="line">Find include file	:cs find 8 or i</span><br><span class="line">Find assignments	:cs find 9 or a</span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>一般情况下，<code>Gtags</code>已能满足需求。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/15/git-Tig-manual/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="huahui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Huahui">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/15/git-Tig-manual/" class="post-title-link" itemprop="url">Tig Manual</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-15 20:06:53 / Modified: 20:07:33" itemprop="dateCreated datePublished" datetime="2022-02-15T20:06:53+08:00">2022-02-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/git/" itemprop="url" rel="index"><span itemprop="name">git</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>NAME</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tig - text-mode interface for Git</span><br></pre></td></tr></table></figure>
<p>SYNOPSIS</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tig        [options] [revisions] [--] [paths]</span><br><span class="line">tig log    [options] [revisions] [--] [paths]</span><br><span class="line">tig show   [options] [revisions] [--] [paths]</span><br><span class="line">tig reflog [options] [revisions]</span><br><span class="line">tig blame  [options] [rev] [--] path</span><br><span class="line">tig grep   [options] [pattern]</span><br><span class="line">tig refs   [options]</span><br><span class="line">tig stash</span><br><span class="line">tig status</span><br><span class="line">tig &lt;      [Git command output]</span><br></pre></td></tr></table></figure>
<p>DESCRIPTION</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Tig is an ncurses-based text-mode interface for git(1). It functions mainly as a Git</span><br><span class="line">repository browser, but can also assist in staging changes for commit at chunk level and</span><br><span class="line">act as a pager for output from various Git commands.</span><br></pre></td></tr></table></figure>
<p>OPTIONS</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">Command line options recognized by Tig include all valid git-log(1) and git-diff(1)</span><br><span class="line">options, as well as the following subcommands and Tig-specific options. The first command</span><br><span class="line">line parameter not starting with &quot;-&quot; is interpreted as being either a revision</span><br><span class="line">specification or a path and will end the option parsing. All additional options will be</span><br><span class="line">passed to the underlying Git command.</span><br><span class="line"></span><br><span class="line">show</span><br><span class="line">    Open diff view using the given git-show(1) options.</span><br><span class="line"></span><br><span class="line">blame</span><br><span class="line">    Show given file annotated by commits. Takes zero or more git-blame(1) options.</span><br><span class="line">    Optionally limited from given revision.</span><br><span class="line"></span><br><span class="line">status</span><br><span class="line">    Start up in status view.</span><br><span class="line"></span><br><span class="line">log</span><br><span class="line">    Start up in log view, displaying git-log(1) output.</span><br><span class="line"></span><br><span class="line">reflog</span><br><span class="line">    Start up in reflog view.</span><br><span class="line"></span><br><span class="line">refs</span><br><span class="line">    Start up in refs view.</span><br><span class="line"></span><br><span class="line">stash</span><br><span class="line">    Start up in stash view.</span><br><span class="line"></span><br><span class="line">grep</span><br><span class="line">    Open the grep view. Supports the same options as git-grep(1).</span><br><span class="line"></span><br><span class="line">+&lt;number&gt;</span><br><span class="line">    Show the first view with line &lt;number&gt; visible and selected.</span><br><span class="line"></span><br><span class="line">-v, --version</span><br><span class="line">    Show version and exit.</span><br><span class="line"></span><br><span class="line">-h, --help</span><br><span class="line">    Show help message and exit.</span><br><span class="line"></span><br><span class="line">-C&lt;path&gt;</span><br><span class="line">    Run as if Tig was started in &lt;path&gt; instead of the current working directory.</span><br></pre></td></tr></table></figure>
<p>PAGER MODE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Tig enters pager mode when input is provided via stdin and supports the following</span><br><span class="line">subcommands and options:</span><br><span class="line"></span><br><span class="line">·   When the show subcommand is specified and the --stdin option is given, stdin is</span><br><span class="line">    assumed to be a list of commit IDs and will be forwarded to the diff view’s underlying</span><br><span class="line">    git-show(1) command. For example:</span><br><span class="line"></span><br><span class="line">    $ git rev-list --author=vivien HEAD | tig show --stdin</span><br><span class="line"></span><br><span class="line">·   When --stdin is given, stdin is assumed to be a list of commit IDs and will be</span><br><span class="line">    forwarded to the main view’s underlying git-log(1) command. For example:</span><br><span class="line"></span><br><span class="line">    $ tig --no-walk --stdin &lt; cherry-picks.txt</span><br><span class="line"></span><br><span class="line">·   When --pretty=raw is given, stdin is assumed to be a &quot;pretty=raw&quot; formatted output</span><br><span class="line">    similar to that of git-log(1). For example:</span><br><span class="line"></span><br><span class="line">    $ git reflog --pretty=raw | tig --pretty=raw</span><br><span class="line"></span><br><span class="line">When no subcommands nor options are given, the pager view will be used for displaying the</span><br><span class="line">Git command input given on stdin. The pager view assumes the input is either from</span><br><span class="line">git-log(1) or git-diff(1) and will highlight it similar to the log and diff views. For</span><br><span class="line">example:</span><br><span class="line"></span><br><span class="line">    $ git log -Schange -p --raw | tig</span><br></pre></td></tr></table></figure>
<p>EXAMPLES</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">Display the list of commits for the current branch:</span><br><span class="line"></span><br><span class="line">    $ tig</span><br><span class="line"></span><br><span class="line">Display commits from one or more branches:</span><br><span class="line"></span><br><span class="line">    $ tig test master</span><br><span class="line"></span><br><span class="line">Pretend as if all the refs in refs/ are listed on the command line:</span><br><span class="line"></span><br><span class="line">    $ tig --all</span><br><span class="line"></span><br><span class="line">Display differences between two branches:</span><br><span class="line"></span><br><span class="line">    $ tig test..master</span><br><span class="line"></span><br><span class="line">Display changes for sub-module versions:</span><br><span class="line"></span><br><span class="line">    $ tig --submodule</span><br><span class="line"></span><br><span class="line">Display changes for a single file:</span><br><span class="line"></span><br><span class="line">    $ tig -- README</span><br><span class="line"></span><br><span class="line">Display contents of the README file in a specific revision:</span><br><span class="line"></span><br><span class="line">    $ tig show tig-0.8:README</span><br><span class="line"></span><br><span class="line">Display revisions between two dates for a specific file:</span><br><span class="line"></span><br><span class="line">    $ tig --after=&quot;2004-01-01&quot; --before=&quot;2006-05-16&quot; -- README</span><br><span class="line"></span><br><span class="line">Blame file with copy detection enabled:</span><br><span class="line"></span><br><span class="line">    $ tig blame -C README</span><br><span class="line"></span><br><span class="line">Display the list of stashes:</span><br><span class="line"></span><br><span class="line">    $ tig stash</span><br><span class="line"></span><br><span class="line">Grep all files for lines containing DEFINE_ENUM:</span><br><span class="line"></span><br><span class="line">    $ tig grep -p DEFINE_ENUM</span><br><span class="line"></span><br><span class="line">Show references (branches, remotes and tags):</span><br><span class="line"></span><br><span class="line">    $ tig refs</span><br><span class="line"></span><br><span class="line">Use word diff in the diff view:</span><br><span class="line"></span><br><span class="line">    $ tig --word-diff=plain</span><br></pre></td></tr></table></figure>
<p>ENVIRONMENT VARIABLES</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">In addition to environment variables used by Git (e.g. GIT_DIR), Tig defines the ones</span><br><span class="line">below. The command related environment variables have access to the internal state of Tig</span><br><span class="line">via replacement variables, such as %(commit) and %(blob). See tigrc(5) for a full list.</span><br><span class="line"></span><br><span class="line">TIGRC_USER</span><br><span class="line">    Path of the user configuration file (defaults to ~/.tigrc or</span><br><span class="line">    $XDG_CONFIG_HOME/tig/config).</span><br><span class="line"></span><br><span class="line">TIGRC_SYSTEM</span><br><span class="line">    Path of the system wide configuration file (defaults to &#123;sysconfdir&#125;/tigrc). Define to</span><br><span class="line">    empty string to use built-in configuration.</span><br><span class="line"></span><br><span class="line">TIG_LS_REMOTE</span><br><span class="line">    Command for retrieving all repository references. The command should output data in</span><br><span class="line">    the same format as git-ls-remote(1).</span><br><span class="line"></span><br><span class="line">TIG_DIFF_OPTS</span><br><span class="line">    The diff options to use in the diff view. The diff view uses git-show(1) for</span><br><span class="line">    formatting and always passes --patch-with-stat. You may also set the diff-options</span><br><span class="line">    setting in the configuration file.</span><br><span class="line"></span><br><span class="line">TIG_TRACE</span><br><span class="line">    Path for trace file where information about Git commands are logged.</span><br><span class="line"></span><br><span class="line">TIG_SCRIPT</span><br><span class="line">    Path to script that should be executed automatically on startup. If this environment</span><br><span class="line">    variable is defined to the empty string, the script is read from stdin. The script is</span><br><span class="line">    interpreted line-by-line and can contain prompt commands and key mappings.</span><br><span class="line"></span><br><span class="line">TIG_NO_DISPLAY</span><br><span class="line">    Open Tig without rendering anything to the terminal. This force Ncurses to write to</span><br><span class="line">    /dev/null. The main use is for automated testing of Tig.</span><br></pre></td></tr></table></figure>
<p>FILES</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$XDG_CONFIG_HOME/tig/config, ~/.config/tig/config, ~/.tigrc</span><br><span class="line">    The Tig user configuration file is loaded in the following way. If $XDG_CONFIG_HOME is</span><br><span class="line">    set, read user configuration from $XDG_CONFIG_HOME/tig/config. If $XDG_CONFIG_HOME is</span><br><span class="line">    empty or undefined, read user configuration from ~/.config/tig/config if it exists and</span><br><span class="line">    fall back to ~/.tigrc if it does not exist. See tigrc(5) for examples.</span><br><span class="line"></span><br><span class="line">/etc/tigrc</span><br><span class="line">    System wide configuration file.</span><br><span class="line"></span><br><span class="line">$GIT_DIR/config, ~/.gitconfig, /etc/gitconfig</span><br><span class="line">    Git configuration files. Read on start-up with the help of git-config(1).</span><br><span class="line"></span><br><span class="line">$XDG_DATA_HOME/tig/history, ~/.local/share/tig/history, ~/.tig_history</span><br><span class="line">    When compiled with readline support, Tig writes a persistent command and search</span><br><span class="line">    history. The location of the history file is determined in the following way. If</span><br><span class="line">    $XDG_DATA_HOME is set and $XDG_DATA_HOME/tig/ exists, store history to</span><br><span class="line">    $XDG_DATA_HOME/tig/history. If $XDG_DATA_HOME is empty or undefined, store history to</span><br><span class="line">    ~/.local/share/tig/history if the directory ~/.local/share/tig/ exists, and fall back</span><br><span class="line">    to ~/.tig_history if it does not exist.</span><br></pre></td></tr></table></figure>
<p>BUGS</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Please visit Tig’s home page[1] or main Git repository[2] for information about new</span><br><span class="line">releases and how to report bugs or feature request.</span><br></pre></td></tr></table></figure>
<p>COPYRIGHT</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Copyright (c) 2006-2014 Jonas Fonseca &lt;jonas.fonseca@gmail.com[3]&gt;</span><br><span class="line"></span><br><span class="line">This program is free software; you can redistribute it and/or modify it under the terms of</span><br><span class="line">the GNU General Public License as published by the Free Software Foundation; either</span><br><span class="line">version 2 of the License, or (at your option) any later version.</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/15/git-Tig/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="huahui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Huahui">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/15/git-Tig/" class="post-title-link" itemprop="url">Tig</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-15 20:04:53 / Modified: 20:06:19" itemprop="dateCreated datePublished" datetime="2022-02-15T20:04:53+08:00">2022-02-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/git/" itemprop="url" rel="index"><span itemprop="name">git</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="How-to-use-Tig-to-browse-Git-logs"><a href="#How-to-use-Tig-to-browse-Git-logs" class="headerlink" title="How to use Tig to browse Git logs"></a>How to use Tig to browse Git logs</h1><p>Tig is more than just a text-mode interface for Git. Here’s how it can enhance your daily workflow.</p>
<p>If you work with Git as your version control system, you’ve likely already resigned yourself to the fact that Git is a complicated beast. It is a fantastic tool, but it can be cumbersome to navigate Git repositories. That’s where a tool like Tig comes in.</p>
<p>From the <a target="_blank" rel="noopener" href="http://manpages.ubuntu.com/manpages/jammy/man1/tig.1.html">Tig man page</a>:</p>
<blockquote>
<p>Tig is an ncurses-based text-mode interface for git. It functions mainly as a Git repository browser, but can also assist in staging changes for commit at chunk level and act as a pager for output from various Git commands.</p>
</blockquote>
<p>This basically means that Tig provides a text-based user interface you can run in your terminal. Tig makes it easy to browse your Git logs, but it can do much more than just bounce you around from your last commit to a previous one.</p>
<p><img src="/2022/02/15/git-Tig/1-default.png"></p>
<p>Many of the examples in this quick introduction to Tig have been poached directly from its excellent man page. I highly recommend reading it to learn more.</p>
<h1 id="Install-Tig"><a href="#Install-Tig" class="headerlink" title="Install Tig"></a>Install Tig</h1><ul>
<li>Fedora and RHEL: <code>sudo dnf install tig</code></li>
<li>Ubuntu and Debian: <code>sudo apt install tig</code></li>
<li>MacOS: <code>brew install tig</code></li>
</ul>
<p>See the official <a target="_blank" rel="noopener" href="https://jonas.github.io/tig/INSTALL.html">installation instructions</a> for even more options.</p>
<h1 id="Browse-commits-in-your-current-branch"><a href="#Browse-commits-in-your-current-branch" class="headerlink" title="Browse commits in your current branch"></a>Browse commits in your current branch</h1><p>If you want to browse the latest commits in your branch, enter:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tig</span><br></pre></td></tr></table></figure>
<p>That’s it. This three-character command will launch a browser where you can navigate the commits in your current branch. You can think of it as a wrapper around <strong>git log</strong>.</p>
<p>To navigate the output, you can use the <code>Up</code> and <code>Down</code> arrow keys to move from one commit to another. Pressing the <code>Return/Enter</code> key will open a vertical split with the contents of the chosen commit on the right-hand side. You can continue to browse up and down in your commit history on the left-hand side, and your changes will appear on the right. Use <code>k</code> and <code>j</code> to navigate up and down by line and <code>-</code> and the <code>Space Bar</code> to page up and down on the right-hand side. Use <code>q</code> to exit the right-hand pane.</p>
<p>Searching on tig output is simple as well. Use <code>/</code> to search forward and <code>?</code> to search backward on both the left and right panes.</p>
<p><img src="/2022/02/15/git-Tig/2-commit.png"></p>
<p>That’s enough to get you started navigating your commits. There are too many key bindings to cover here, but clicking <code>h</code> will display a Help menu where you can discover its navigation and command options. You can also use <code>/</code> and <code>?</code> to search the Help menu. Use <code>q</code> to exit Help.</p>
<p><img src="/2022/02/15/git-Tig/3-help.png"></p>
<h1 id="Browse-revisions-for-a-single-file"><a href="#Browse-revisions-for-a-single-file" class="headerlink" title="Browse revisions for a single file"></a>Browse revisions for a single file</h1><p>Since Tig is a wrapper around <code>git log</code>, it conveniently accepts the same arguments that can be passed to <code>git log</code>. For instance, to browse the commit history for a single file, enter:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tig README.md</span><br></pre></td></tr></table></figure>
<p>Compare this with the output of the Git command being wrapped to get a clearer view of how Tig enhances the output.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log README.md</span><br></pre></td></tr></table></figure>
<p>To include the patches in the raw Git output, you can add a <code>-p</code> option:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log -p README.md</span><br></pre></td></tr></table></figure>
<p>If you want to narrow the commits down to a specific date range, try something like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tig --after=&quot;2017-01-01&quot; --before=&quot;2018-05-16&quot; -- README.md</span><br></pre></td></tr></table></figure>
<p>Again, you can compare this with the raw Git version:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log --after=&quot;2017-01-01&quot; --before=&quot;2018-05-16&quot; -- README.md</span><br></pre></td></tr></table></figure>
<h1 id="Browse-who-changed-a-file"><a href="#Browse-who-changed-a-file" class="headerlink" title="Browse who changed a file"></a>Browse who changed a file</h1><p>Sometimes you want to find out who made a change to a file and why. The command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tig blame README.md</span><br></pre></td></tr></table></figure>
<p>is essentially a wrapper around <code>git blame</code>. As you would expect, it allows you to see who the last person was to edit a given line, and it also allows you to navigate to the commit that introduced the line. This is somewhat like the <code>:Gblame</code> command Vim’s <code>vim-fugitive</code> plugin provides.</p>
<h1 id="Browse-your-stash"><a href="#Browse-your-stash" class="headerlink" title="Browse your stash"></a>Browse your stash</h1><p>If you’re like me, you may have a pile of edits in your stash. It’s easy to lose track of them. You can view the latest item in your stash via: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git stash show -p stash@&#123;0&#125;</span><br></pre></td></tr></table></figure>
<p>You can find the second most recent item via:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git stash show -p stash@&#123;1&#125;</span><br></pre></td></tr></table></figure>
<p>and so on. If you can recall these commands whenever you need them, you have a much sharper memory than I do.</p>
<p>As with the Git commands above, Tig makes it easy to enhance your Git output with a simple invocation:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tig stash</span><br></pre></td></tr></table></figure>
<p>Try issuing this command in a repository with a populated stash. You’ll be able to browse and search your stash items, giving you a quick overview of everything you saved for a rainy day.</p>
<h1 id="Browse-your-refs"><a href="#Browse-your-refs" class="headerlink" title="Browse your refs"></a>Browse your refs</h1><p>A Git ref is the hash of something you have committed. This includes files as well as branches. Using the <code>tig refs</code> command allows you to browse all of your refs and drill down to specific commits.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tig refs</span><br></pre></td></tr></table></figure>
<p>When you’re finished, use <code>q</code> to return to a previous menu.</p>
<h1 id="Browse-git-status"><a href="#Browse-git-status" class="headerlink" title="Browse git status"></a>Browse git status</h1><p>If you want to view which files have been staged and which are untracked, use tig status, a wrapper around <code>git status</code>.</p>
<p><img src="/2022/02/15/git-Tig/4-status.png"></p>
<h1 id="Browse-git-grep"><a href="#Browse-git-grep" class="headerlink" title="Browse git grep"></a>Browse git grep</h1><p>You can use the <code>grep</code> command to search for expressions in text files. The command <code>tig grep</code> allows you to navigate the output of <code>git grep</code>. For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tig grep -i foo lib/Bar</span><br></pre></td></tr></table></figure>
<p>will navigate the output of a case-insensitive search for <code>foo</code> in the <code>lib/Bar</code> directory.</p>
<h1 id="Pipe-output-to-Tig-via-STDIN"><a href="#Pipe-output-to-Tig-via-STDIN" class="headerlink" title="Pipe output to Tig via STDIN"></a>Pipe output to Tig via STDIN</h1><p>If you are piping a list of commit IDs to Tig, you must use the <code>--stdin</code> flag so that <code>tig show</code> reads from stdin. Otherwise, <code>tig show</code> launches without input (rendering an empty screen).</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rev-list --author=olaf HEAD | tig show --stdin</span><br></pre></td></tr></table></figure>
<h1 id="Add-custom-bindings"><a href="#Add-custom-bindings" class="headerlink" title="Add custom bindings"></a>Add custom bindings</h1><p>You can customize Tig with an <code>rc</code> file. Here’s how you can configure Tig to your liking, using the example of adding some helpful custom key bindings.</p>
<p>Create a file in your home directory called <code>.tigrc</code>. Open <code>~/.tigrc</code> in your favorite editor and add:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Apply the selected stash</span><br><span class="line">bind stash a !?git stash apply %(stash)</span><br><span class="line"></span><br><span class="line"># Drop the selected stash item</span><br><span class="line">bind stash x !?git stash drop %(stash)</span><br></pre></td></tr></table></figure>
<p>Run <code>tig stash</code> to browse your stash, as above. However, with these bindings in place, you can press <code>a</code> to apply an item from the stash to your repository and <code>x</code> to drop an item from the stash. Keep in mind that you’ll need to perform these commands when browsing the stash list. If you’re browsing a stash item, enter <code>q</code> to exit that view and press <code>a</code> or <code>x</code> to get the effect you want.</p>
<p>For more information, you can read more about <a target="_blank" rel="noopener" href="https://github.com/jonas/tig/wiki/Bindings">Tig key bindings.</a></p>
<p>Wrapping up<br>I hope this has been a helpful demonstration of how Tig can enhance your daily workflow. Tig can do even more powerful things (such as staging lines of code), but that’s outside the scope of this introductory article. There’s enough information here to make you dangerous, but there’s still more to explore.</p>
<p>via: <a target="_blank" rel="noopener" href="https://opensource.com/article/19/6/what-tig">https://opensource.com/article/19/6/what-tig</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/15/makefile-makefile/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="huahui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Huahui">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/15/makefile-makefile/" class="post-title-link" itemprop="url">Makefile 特殊符号</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-15 20:00:52 / Modified: 20:01:39" itemprop="dateCreated datePublished" datetime="2022-02-15T20:00:52+08:00">2022-02-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/makefile/" itemprop="url" rel="index"><span itemprop="name">makefile</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Makefile-特殊符号"><a href="#Makefile-特殊符号" class="headerlink" title="Makefile 特殊符号"></a>Makefile 特殊符号</h1><p> <code>- @ + $ $$</code></p>
<h2 id="符号-连字符"><a href="#符号-连字符" class="headerlink" title="- 符号 (连字符)"></a><code>-</code> 符号 (连字符)</h2><p>任何命令行的任何非零退出状态都被忽略，忽略当前命令行执行时所遇到的错误。<br>make 在执行命令的时候，如果遇到 error，会退出执行。加上减号的目的是即便此命令行执行出错，那么也不要管，继续执行 make。<br>通常删除或者创建文件时，遇到文件不存在或者已经创建。如果希望忽略掉错误，继续执行，就可以在命令行前面添加 <code>-</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.PHONY : clean</span><br><span class="line">clean :</span><br><span class="line">	-rm $(objects)</span><br></pre></td></tr></table></figure>
<h2 id="符号-at-符号"><a href="#符号-at-符号" class="headerlink" title="@ 符号 (at 符号)"></a><code>@</code> 符号 (at 符号)</h2><p>通常 makefile 会将其执行的命令行在执行前输出到屏幕上。如果将 @ 添加到命令行前，这个命令将不被 make 回显出来，<strong>即不显示命令本身而只显示结果</strong>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">all :</span><br><span class="line">	@echo &quot;Make&quot;</span><br></pre></td></tr></table></figure>
<h2 id="符号-加号"><a href="#符号-加号" class="headerlink" title="+ 符号 (加号)"></a><code>+</code> 符号 (加号)</h2><p>使用加号修饰符让命令始终执行。命令行执行时不受到 make 的 -n -t -q 三个参数的影响，忽略这三个参数。<br>如果 make 执行时，使用 -n 或 –just-print。该参数显示命令，不会执行命令。这个功能有利于调试 Makefile，方便查看执行的命令形式和顺序。</p>
<h2 id="符号-美元符号"><a href="#符号-美元符号" class="headerlink" title="$ 符号 (美元符号)"></a><code>$</code> 符号 (美元符号)</h2><p>美元符号 <code>$</code>，扩展打开 makefile 中定义的变量。</p>
<h2 id="符号"><a href="#符号" class="headerlink" title="$$ 符号"></a><code>$$</code> 符号</h2><p><code>$$</code> 符号，扩展打开 makefile 中定义的 shell 变量。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/15/gdb-gdb-memory/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="huahui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Huahui">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/15/gdb-gdb-memory/" class="post-title-link" itemprop="url">GDB 内存操作</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-15 19:59:04 / Modified: 20:01:54" itemprop="dateCreated datePublished" datetime="2022-02-15T19:59:04+08:00">2022-02-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/gdb/" itemprop="url" rel="index"><span itemprop="name">gdb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="gdb查看内存数据"><a href="#gdb查看内存数据" class="headerlink" title="gdb查看内存数据"></a>gdb查看内存数据</h1><p>格式: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x/nfu</span><br></pre></td></tr></table></figure>
<p>说明：</p>
<ul>
<li><code>x</code> 是 examine 的缩写，意思是检查</li>
<li><code>n</code>表示要显示的内存单元的个数</li>
<li><code>f</code>表示显示方式</li>
<li><code>u</code>表示一个地址单元的长度：</li>
</ul>
<h2 id="显示方式-f-取值"><a href="#显示方式-f-取值" class="headerlink" title="显示方式 f 取值"></a>显示方式 f 取值</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x 按十六进制格式显示变量。</span><br><span class="line">d 按十进制格式显示变量。</span><br><span class="line">u 按十进制格式显示无符号整型。</span><br><span class="line">o 按八进制格式显示变量。</span><br><span class="line">t 按二进制格式显示变量。</span><br><span class="line">a 按十六进制格式显示变量。</span><br><span class="line">i 指令地址格式</span><br><span class="line">c 按字符格式显示变量。</span><br><span class="line">f 按浮点数格式显示变量。</span><br></pre></td></tr></table></figure>
<h2 id="地址单元长度-u-取值"><a href="#地址单元长度-u-取值" class="headerlink" title="地址单元长度 u 取值"></a>地址单元长度 u 取值</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">b表示单字节，</span><br><span class="line">h表示双字节，</span><br><span class="line">w表示四字节，</span><br><span class="line">g表示八字节</span><br></pre></td></tr></table></figure>

<h2 id="example"><a href="#example" class="headerlink" title="example"></a>example</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x/50xw 0x40451400</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>50</code>是数量，<code>x</code>是16进制，<code>w</code>是四字节</p>
<h1 id="Examining-Memory"><a href="#Examining-Memory" class="headerlink" title="Examining Memory"></a>Examining Memory</h1><p>You can use the command <code>x</code> (for “examine”) to examine memory in any of several formats, independently of your program’s data types.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x/nfu addr</span><br><span class="line">x addr</span><br><span class="line">x</span><br></pre></td></tr></table></figure>

<p>Use the x command to examine memory.</p>
<p><code>n</code>, <code>f</code>, and <code>u</code> are all optional parameters that specify how much memory to display and how to format it; addr is an expression giving the address where you want to start displaying memory. If you use defaults for nfu, you need not type the slash ‘/’. Several commands set convenient defaults for addr.</p>
<h2 id="n-the-repeat-count"><a href="#n-the-repeat-count" class="headerlink" title="n, the repeat count"></a>n, the repeat count</h2><pre><code>The repeat count is a decimal integer; the default is 1. 
It specifies how much memory (counting by units u) to display. 
If a negative number is specified, memory is examined backward from addr.
</code></pre>
<h2 id="f-the-display-format"><a href="#f-the-display-format" class="headerlink" title="f, the display format"></a>f, the display format</h2><pre><code>The display format is one of the formats used by print 
(‘x’, ‘d’, ‘u’, ‘o’, ‘t’, ‘a’, ‘c’, ‘f’, ‘s’), 
‘i’ (for machine instructions) and ‘m’ (for displaying memory tags). 
The default is ‘x’ (hexadecimal) initially. 
The default changes each time you use either x or print.
</code></pre>
<h2 id="u-the-unit-size"><a href="#u-the-unit-size" class="headerlink" title="u, the unit size"></a>u, the unit size</h2><p>The unit size is any of</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">b</span><br><span class="line">Bytes.</span><br><span class="line"></span><br><span class="line">h</span><br><span class="line">Halfwords (two bytes).</span><br><span class="line"></span><br><span class="line">w</span><br><span class="line">Words (four bytes). This is the initial default.</span><br><span class="line"></span><br><span class="line">g</span><br><span class="line">Giant words (eight bytes).</span><br></pre></td></tr></table></figure>

<ul>
<li>Each time you specify a unit size with x, that size becomes the default unit the next time you use x. </li>
<li>For the ‘i’ format, the unit size is ignored and is normally not written. </li>
<li>For the ‘s’ format, the unit size defaults to ‘b’, unless it is explicitly given. </li>
<li>Use x /hs to display 16-bit char strings and x /ws to display 32-bit strings. The next use of x /s will again display 8-bit strings. </li>
<li>Note that the results depend on the programming language of the current compilation unit. </li>
<li>If the language is C, the ‘s’ modifier will use the UTF-16 encoding while ‘w’ will use UTF-32. The encoding is set by the programming language and cannot be altered.</li>
</ul>
<h1 id="modify-memory"><a href="#modify-memory" class="headerlink" title="modify memory"></a>modify memory</h1><p>In order to set the variable g, use </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) set var g=4</span><br></pre></td></tr></table></figure>
<p>GDB allows more implicit conversions in assignments than C; you can freely store an integer value into a pointer variable or vice versa,<br>and you can convert any structure to any other structure that is the same length or shorter.</p>
<p>To store values into arbitrary places in memory, use the ‘{…}’ construct to generate a value of specified type at a specified address (see Expressions).<br>For example, {int}0x83040 refers to memory location 0x83040 as an integer (which implies a certain size and representation in memory), and</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set &#123;int&#125;0x83040 = 4</span><br></pre></td></tr></table></figure>
<p>stores the value 4 into that memory location.</p>
<p>This should work for any valid pointer, and can be cast to any appropriate data type.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set *((int *) 0xbfbb0000) = 20</span><br></pre></td></tr></table></figure>

<p>e.g.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">set *(unsigned char      *)&lt;memaddr&gt; = &lt;value&gt;  ; write 1 byte</span><br><span class="line">set *(unsigned short     *)&lt;memaddr&gt; = &lt;value&gt;  ; write 2 bytes</span><br><span class="line">set *(unsigned int       *)&lt;memaddr&gt; = &lt;value&gt;  ; write 4 bytes</span><br><span class="line">set *(unsigned long long *)&lt;memaddr&gt; = &lt;value&gt;  ; write 8 bytes</span><br><span class="line"> </span><br><span class="line">or</span><br><span class="line"> </span><br><span class="line">set *(char      *)&lt;memaddr&gt; = &lt;value&gt;           ; write 1 byte</span><br><span class="line">set *(short     *)&lt;memaddr&gt; = &lt;value&gt;           ; write 2 bytes</span><br><span class="line">set *(int       *)&lt;memaddr&gt; = &lt;value&gt;           ; write 4 bytes</span><br><span class="line">set *(long long *)&lt;memaddr&gt; = &lt;value&gt;           ; write 8 bytes</span><br></pre></td></tr></table></figure>

<p>or use</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set *0xbfbb0000=20</span><br></pre></td></tr></table></figure>
<p>change memory locations directly.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/13/C%E7%BC%96%E7%A8%8B-inline/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="huahui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Huahui">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/13/C%E7%BC%96%E7%A8%8B-inline/" class="post-title-link" itemprop="url">Inline</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-13 16:08:56 / Modified: 16:48:59" itemprop="dateCreated datePublished" datetime="2022-02-13T16:08:56+08:00">2022-02-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/C%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">C编程</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="inline-内联函数"><a href="#inline-内联函数" class="headerlink" title="inline 内联函数"></a>inline 内联函数</h1><p>有些函数短小精悍而且调用频繁，调用开销大，经常保护现场，恢复现场，算下来性价比不高。这时就可以将这个函数声明为内联函数。编译器在编译过程中遇到内联函数，<strong>像宏一样，将内联函数直接在调用处展开</strong>，这样就可以减少函数调用的开支：<strong>直接执行内联函数展开的代码，不用再保存现场和恢复现场</strong>。</p>
<h2 id="内联函数和宏"><a href="#内联函数和宏" class="headerlink" title="内联函数和宏"></a>内联函数和宏</h2><p>内联函数和宏的功能差不多，为什么不直接定义一个宏定义？而是定义一个内联函数？</p>
<p>存在即合理，内联函数在 C 语言中有广泛运用，自然有其原因。与宏相比，内联函数有以下优势：</p>
<ul>
<li><p>参数类型检查</p>
<pre><code>    内联函数随有宏的展开特性，但其本质仍是函数，在编译过程中，编译器仍可以对其进行参数检查，而宏不具备这个功能。
</code></pre>
</li>
<li><p>便于调试</p>
<p>​        函数支持的调试功能有断点、单步等，内联函数同样支持。        </p>
</li>
<li><p>返回值</p>
<p>​        内联函数有返回值，返回一个结果给调用者。这个优势是相对 ANSI C 说的，因为现在宏也可以有返回值和类型了，如前面使用语句表达式的宏。</p>
</li>
<li><p>接口封装</p>
<p>​        有些内联函数可以用来封装一个接口，而宏不具备这个功能。</p>
</li>
</ul>
<h2 id="内联函数不足"><a href="#内联函数不足" class="headerlink" title="内联函数不足"></a>内联函数不足</h2><p>内联函数并不是完美无瑕的，也存在不足。</p>
<ul>
<li>内联函数会增大函数体积。<br>  如果一个文件中多次调用内联函数，多次展开，那整个程序的体积就会变大，在一定程度上会减低程序的执行效率。</li>
<li>减低代码复用性。<br>  函数的作用之一就是提高代码的复用性。我们将一些代码封装成函数，进行模块化编程，可以减轻软件开发的工作量，而内联函数往往又减低函数的复用性。</li>
</ul>
<h2 id="编译器对内联函数的处理"><a href="#编译器对内联函数的处理" class="headerlink" title="编译器对内联函数的处理"></a>编译器对内联函数的处理</h2><p>我们通过 <code>inline</code>关键字将一个函数声明为内联函数，但编译器不一定会对这个内联函数在进行展开。编译器也要根据实际情况进行评估。除了检测用户定义的内联函数是否含有指针、循环、递归，还会在函数执行效率和函数调用开销之间进行权衡。</p>
<p>从程序员角度出发，是否展开主要考虑如下因素：</p>
<ul>
<li>函数体积大小</li>
<li>函数体内无指针赋值、递归、循环等语句</li>
<li>调用频繁</li>
</ul>
<p>当我们认为一个函数体积小，而且被大量调用，应该做内联展开。</p>
<h3 id="属性声明：noinline"><a href="#属性声明：noinline" class="headerlink" title="属性声明：noinline"></a>属性声明：noinline</h3><p>明确告诉编译器不展开内联函数</p>
<h3 id="属性声明：always-inline"><a href="#属性声明：always-inline" class="headerlink" title="属性声明：always_inline"></a>属性声明：always_inline</h3><p>明确告诉编译器展开内联函数</p>
<h2 id="内联函数定义在头文件中"><a href="#内联函数定义在头文件中" class="headerlink" title="内联函数定义在头文件中"></a>内联函数定义在头文件中</h2><p>在Linux 内核中，有大量的内联函数被定义在头文件中，而且经常使用 <code>static</code>修饰。</p>
<p>Q: 为什么内联函数要定义在头文件中？</p>
<blockquote>
<p> A: 因为它是一个内联函数，可以像宏一样展开，任何像使用这个内联函数的源文件，都不必亲自去定义一遍，直接包含这个头文件即可，即像宏定义一样使用。</p>
</blockquote>
<p>Q：为什么要加<code>static</code>修饰</p>
<blockquote>
<p>inline 定义的内联函数不一定会展开，当一个工程中多个文件都包含这个内联函数的定义时，编译时就有可能报重定义错误。使用 static 关键字修饰，则可以将这个函数的作用域限制在各自的文件内，避免重定义错误的发生。</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/13/Linux%E9%A9%B1%E5%8A%A8-LCD%E9%A9%B1%E5%8A%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="huahui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Huahui">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/13/Linux%E9%A9%B1%E5%8A%A8-LCD%E9%A9%B1%E5%8A%A8/" class="post-title-link" itemprop="url">Framebuffer</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-13 15:58:36 / Modified: 16:05:09" itemprop="dateCreated datePublished" datetime="2022-02-13T15:58:36+08:00">2022-02-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux%E9%A9%B1%E5%8A%A8/" itemprop="url" rel="index"><span itemprop="name">Linux驱动</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>像素颜色</p>
<p>用红绿蓝三颜色来表示，可以用24位数据来表示红绿蓝，也可以用16位等等格式，比如：</p>
<ul>
<li>bpp：bits per pixel，每个像素用多少位来表示</li>
<li>24bpp：实际上会用到32位，其中8位未使用，其余24位中分别用8位表示红(R)、绿(G)、蓝(B) 。24位使用32位来存储方便寻址。</li>
<li>16bpp：有rbg565，rgb555<ul>
<li>rgb565：用5位表示红、6位表示绿、5位表示蓝。人眼对绿色较敏感，能分辨出其中的细微差别</li>
<li>rgb555：16位数据中用5位表示红、5位表示绿、5位表示蓝，浪费一位</li>
</ul>
</li>
</ul>
<p><img src="002_rgb.png"></p>
<p>注：有些LCD控制器可以设置红绿蓝三原色的位置，比如24位的数据里，可能是RGB888，也可能是BGR888</p>
<h1 id="Framebuffer"><a href="#Framebuffer" class="headerlink" title="Framebuffer"></a>Framebuffer</h1><p>存储像素数据的一块特殊内存，<strong>显存</strong></p>
<ul>
<li>也有芯片手册称为 <strong>GRAM</strong>, G指图形</li>
</ul>
<h2 id="对于应用工程师"><a href="#对于应用工程师" class="headerlink" title="对于应用工程师"></a>对于<strong>应用工程师</strong></h2><p>使用LCD只需要掌握三点：</p>
<ol>
<li>颜色格式：16bpp/24bpp</li>
<li>Framebuffer基地址</li>
<li>LCD屏幕分辨率，根据分辨率才能找到像素点在显存的任意位置</li>
</ol>
<p>应用工程师将数据写入Framebuffer即可，LCD controler （LCD控制器）会帮助更新屏幕上像素的颜色。</p>
<h2 id="对于驱动工程师"><a href="#对于驱动工程师" class="headerlink" title="对于驱动工程师"></a>对于驱动工程师</h2><p>对LCD的理解要深入硬件，比如要回答这几个问题：</p>
<ul>
<li>Framebuffer在哪里？</li>
</ul>
<p>LCD里面还是LCD外面</p>
<ul>
<li>谁把Framebuffer中的数据发给LCD？</li>
</ul>
<p>LCD controler，驱动工程师很大一部分工作既是设置初始化LCD controler</p>
<h1 id="统一的硬件模型"><a href="#统一的硬件模型" class="headerlink" title="统一的硬件模型"></a>统一的硬件模型</h1><p>LCD接口众多，但硬件模型一致，原理一致</p>
<p><img src="004_lcd_hardware_block.png"></p>
<h2 id="MCU常用的8080接口LCD模组"><a href="#MCU常用的8080接口LCD模组" class="headerlink" title="MCU常用的8080接口LCD模组"></a>MCU常用的8080接口LCD模组</h2><p>内存，LCD控制器，LCD屏幕组合成一个<strong>LCM模组</strong>，单片机F103直接跟模组通信</p>
<p>F103一般通过以下信号线跟LCM模组通信</p>
<ul>
<li>CS 片选线</li>
<li>RD / WD 读写控制线</li>
<li>DataBus 数据总线</li>
<li>Data / cmd 控制引脚，决定DataBus上传输的是数据还是地址等其他信息</li>
</ul>
<h2 id="MPU常用的TFT-RGB接口"><a href="#MPU常用的TFT-RGB接口" class="headerlink" title="MPU常用的TFT RGB接口"></a>MPU常用的TFT RGB接口</h2><p>只有LCD屏幕在外面，LCD控制器位于ARM芯片内部，可外接显存。LCD控制器通过RGB三组线以及其他控制信号线对LCD屏幕进行控制</p>
<ul>
<li>DCLK 移动一个像素点</li>
<li>HSYNC 从最右跳到下一行</li>
<li>VSYNC 从最后一个跳到第一个</li>
<li>DE 决定是否接受RGB数据，在像素点跳转时禁用RGB数据</li>
</ul>
<h2 id="RGB三组线"><a href="#RGB三组线" class="headerlink" title="RGB三组线"></a>RGB三组线</h2><ul>
<li><p>对于使用真彩色的LCD控制器，RGB引脚上的数据直接来自自Framebuffer；</p>
</li>
<li><p>对于使用调色板的LCD控制器，Framebuffer中的数据只是用来取出调色板中的颜色，调色板中的数据会被放到RGB引脚上去。</p>
</li>
</ul>
<h1 id="编写Framebuffer框架"><a href="#编写Framebuffer框架" class="headerlink" title="编写Framebuffer框架"></a>编写Framebuffer框架</h1><p>分配显存时，不可以使用kmalloc函数。</p>
<p>显存要保证物理地址连续，kamlloc函数分配的内存可以保证虚拟地址的联系，但在物理地址上不一定是连续的。</p>
<p>Framebuffer框架分为上下两层：</p>
<ul>
<li>fbmem.c：承上启下<ul>
<li>实现、注册file_operations结构体</li>
<li>把APP的调用向下转发到具体的硬件驱动程序</li>
</ul>
</li>
<li>xxx_fb.c：硬件相关的驱动程序<ul>
<li>实现、注册fb_info结构体</li>
<li>实现硬件操作</li>
</ul>
</li>
</ul>
<h2 id="Framebuffer核心："><a href="#Framebuffer核心：" class="headerlink" title="Framebuffer核心："></a>Framebuffer核心：</h2><ul>
<li><p>分配fb_info</p>
<ul>
<li>framebuffer_alloc</li>
</ul>
</li>
<li><p>设置fb_info</p>
<ul>
<li>var</li>
<li>fbops</li>
<li>硬件相关操作</li>
</ul>
</li>
<li><p>注册fb_info</p>
<ul>
<li>register_framebuffer</li>
</ul>
</li>
</ul>
<h1 id="imx6ull-LCD-控制器"><a href="#imx6ull-LCD-控制器" class="headerlink" title="imx6ull LCD 控制器"></a>imx6ull LCD 控制器</h1><h2 id="控制器模块"><a href="#控制器模块" class="headerlink" title="控制器模块"></a>控制器模块</h2><ul>
<li>硬件框架</li>
<li>数据传输与处理</li>
<li>时序控制</li>
</ul>
<p>数据处理过程</p>
<ol>
<li>从显存读数据 32bit * n</li>
<li>判断是否交换</li>
<li>使用哪种RGB格式 RGB555， RGB565, RGB888</li>
<li>设置时序，用于发送数据</li>
<li>RGB 数据格式 跟LCD屏幕匹配</li>
</ol>
<p>例如：RGB 888 - &gt; 16bpp的LCD ，在8位中只传五位</p>
<h2 id="LCD控制器寄存器简介"><a href="#LCD控制器寄存器简介" class="headerlink" title="LCD控制器寄存器简介"></a>LCD控制器寄存器简介</h2><p>查看任何芯片的LCD控制器寄存器时，记住几个要点：</p>
<p>① 怎么把LCD的信息告诉LCD控制器：即分辨率、行列时序、像素时钟等；<br>② 怎么把显存地址、像素格式告诉LCD控制器。</p>
<h1 id="内核中的LCD驱动程序"><a href="#内核中的LCD驱动程序" class="headerlink" title="内核中的LCD驱动程序"></a>内核中的LCD驱动程序</h1><p>如何确定内存LCD驱动程序</p>
<p>在已经编译好的内核中 <code>drivers/video/fbdev</code>目录下，有哪些<code>.o</code>文件，对应的<code>.c</code>文件。</p>
<h1 id="编程-LCD驱动程序框架-使用设备树"><a href="#编程-LCD驱动程序框架-使用设备树" class="headerlink" title="编程_LCD驱动程序框架_使用设备树"></a>编程_LCD驱动程序框架_使用设备树</h1><p>Linux驱动程序 = 驱动程序框架 + 硬件编程。</p>
<p>驱动程序框架核心就是：</p>
<ul>
<li>分配fb_info</li>
<li>设置fb_info</li>
<li>注册fb_info</li>
<li>硬件相关的设置</li>
</ul>
<h2 id="硬件相关的设置"><a href="#硬件相关的设置" class="headerlink" title="硬件相关的设置"></a>硬件相关的设置</h2><ul>
<li>引脚设置</li>
<li>时钟设置</li>
<li>LCD控制器设置</li>
</ul>
<p>入口函数注册<code>platform_driver</code></p>
<p>设备树结点：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">framebuffer-mylcd &#123;</span><br><span class="line">        compatible = &quot;huahui,lcd_drv&quot;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="编写probe函数"><a href="#编写probe函数" class="headerlink" title="编写probe函数"></a>编写probe函数</h2><ul>
<li>驱动程序框架核心 fb_info</li>
<li>硬件相关的设置</li>
</ul>
<h1 id="引脚配置"><a href="#引脚配置" class="headerlink" title="引脚配置"></a>引脚配置</h1><p>主要使用<strong>pinctrl子系统</strong>把引脚配置为LCD功能，对于背光引脚等使用<strong>GPIO子系统</strong>的函数控制它的输出电平。</p>
<p>设备树结点</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pinctrl-names = <span class="string">&quot;default&quot;</span>;</span><br><span class="line">pinctrl<span class="number">-0</span> = &lt;&amp;pmylcd_pinctrl&gt;;</span><br><span class="line">backlight-gpios = &lt;&amp;gpio1 <span class="number">8</span> GPIO_ACTIVE_HIGH&gt;;</span><br></pre></td></tr></table></figure>



<h1 id="时钟配置"><a href="#时钟配置" class="headerlink" title="时钟配置"></a>时钟配置</h1><p>通过芯片手册，查看需要使能那些时钟</p>
<p>设备树结点</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">clocks = &lt;&amp;clks IMX6UL_CLK_LCDIF_PIX&gt;,</span><br><span class="line">         &lt;&amp;clks IMX6UL_CLK_LCDIF_APB&gt;;</span><br><span class="line">clock-names = <span class="string">&quot;pix&quot;</span>, <span class="string">&quot;axi&quot;</span>;</span><br></pre></td></tr></table></figure>

<h1 id="配置LCD控制器"><a href="#配置LCD控制器" class="headerlink" title="配置LCD控制器"></a>配置LCD控制器</h1><h2 id="在设备树里指定LCD参数"><a href="#在设备树里指定LCD参数" class="headerlink" title="在设备树里指定LCD参数"></a>在设备树里指定LCD参数</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">framebuffer-mylcd &#123;</span><br><span class="line">		compatible = &quot;100ask,lcd_drv&quot;;</span><br><span class="line">        pinctrl-names = &quot;default&quot;;</span><br><span class="line">		pinctrl-0 = &lt;&amp;mylcd_pinctrl&gt;;</span><br><span class="line">		backlight-gpios = &lt;&amp;gpio1 8 GPIO_ACTIVE_HIGH&gt;;</span><br><span class="line"></span><br><span class="line">           clocks = &lt;&amp;clks IMX6UL_CLK_LCDIF_PIX&gt;,</span><br><span class="line">                    &lt;&amp;clks IMX6UL_CLK_LCDIF_APB&gt;;</span><br><span class="line">           clock-names = &quot;pix&quot;, &quot;axi&quot;;</span><br><span class="line">           </span><br><span class="line">           display = &lt;&amp;display0&gt;;</span><br><span class="line"></span><br><span class="line">		display0: display &#123;</span><br><span class="line">			bits-per-pixel = &lt;24&gt;;</span><br><span class="line">			bus-width = &lt;24&gt;;</span><br><span class="line"></span><br><span class="line">			display-timings &#123;</span><br><span class="line">				native-mode = &lt;&amp;timing0&gt;;</span><br><span class="line"></span><br><span class="line">				 timing0: timing0_1024x768 &#123;</span><br><span class="line">				 clock-frequency = &lt;50000000&gt;;</span><br><span class="line">				 hactive = &lt;1024&gt;;</span><br><span class="line">				 vactive = &lt;600&gt;;</span><br><span class="line">				 hfront-porch = &lt;160&gt;;</span><br><span class="line">				 hback-porch = &lt;140&gt;;</span><br><span class="line">				 hsync-len = &lt;20&gt;;</span><br><span class="line">				 vback-porch = &lt;20&gt;;</span><br><span class="line">				 vfront-porch = &lt;12&gt;;</span><br><span class="line">				 vsync-len = &lt;3&gt;;</span><br><span class="line"></span><br><span class="line">				 hsync-active = &lt;0&gt;;</span><br><span class="line">				 vsync-active = &lt;0&gt;;</span><br><span class="line">				 de-active = &lt;1&gt;;</span><br><span class="line">				 pixelclk-active = &lt;0&gt;;</span><br><span class="line">				 &#125;;</span><br><span class="line"></span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;;            </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h2 id="从设备树获得参数"><a href="#从设备树获得参数" class="headerlink" title="从设备树获得参数"></a>从设备树获得参数</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> ret;</span><br><span class="line">u32 width;</span><br><span class="line">u32 bits_per_pixel;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">display_timings</span> *<span class="title">timings</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* get display node from device tree , pdev-&gt;dev.of_node : from father node*/</span></span><br><span class="line">display_np = of_parse_phandle(pdev-&gt;dev.of_node, <span class="string">&quot;display&quot;</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* get common info 通用属性 */</span></span><br><span class="line">ret = of_property_read_u32(display_np, <span class="string">&quot;bus-width&quot;</span>, &amp;width);</span><br><span class="line">ret = of_property_read_u32(display_np, <span class="string">&quot;bits-per-pixel&quot;</span>,</span><br><span class="line">			   &amp;bits_per_pixel);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* get timings from device tree */</span></span><br><span class="line">  timings = of_get_display_timings(display_np);</span><br></pre></td></tr></table></figure>

<h2 id="使用参数配置LCD控制器"><a href="#使用参数配置LCD控制器" class="headerlink" title="使用参数配置LCD控制器"></a>使用参数配置LCD控制器</h2><p>根据芯片手册，一个一个设置寄存器：</p>
<ul>
<li>Framebuffer地址设置</li>
<li>Framebuffer中数据格式设置</li>
<li>LCD时序参数设置</li>
<li>LCD引脚极性设置</li>
</ul>
<p>注意：硬件参数，例如lcd控制器物理地址等，最好在设备树中指定，而不是写在代码中</p>
<h1 id="调试LCD驱动程序"><a href="#调试LCD驱动程序" class="headerlink" title="调试LCD驱动程序"></a>调试LCD驱动程序</h1><p>要做的事情</p>
<ul>
<li><p>去除内核自带的驱动程序</p>
</li>
<li><p>加入我们编写的驱动程序、设备树文件</p>
</li>
<li><p>重新编译内核、设备树</p>
</li>
<li><p>上机测试：使用编译出来的内核、设备树启动板子</p>
</li>
</ul>
<h1 id="单Buffer的缺点与改进方法"><a href="#单Buffer的缺点与改进方法" class="headerlink" title="单Buffer的缺点与改进方法"></a>单Buffer的缺点与改进方法</h1><h2 id="单buffer的缺点"><a href="#单buffer的缺点" class="headerlink" title="单buffer的缺点"></a>单buffer的缺点</h2><ul>
<li><p>如果APP速度很慢，可以看到它在LCD上缓慢绘制图案</p>
</li>
<li><p>即使APP速度很高，LCD控制器不断从Framebuffer中读取数据来显示，而APP不断把数据写入Framebuffer</p>
<ul>
<li><p>假设APP想把LCD显示为整屏幕的蓝色、红色</p>
</li>
<li><p>很大几率出现这种情况：</p>
<ul>
<li><p>LCD控制器读取Framebuffer数据，读到一半时，在LCD上显示了半屏幕的蓝色</p>
</li>
<li><p>这是APP非常高效地把整个Framebuffer的数据都改为了红色</p>
</li>
<li><p>LCD控制器继续读取数据，于是LCD上就会显示半屏幕蓝色、半屏幕红色</p>
</li>
<li><p>人眼就会感觉到屏幕闪烁、撕裂</p>
<img src="048_singble_buffer.png" style="zoom:53%;" /></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="使用多Buffer来改进"><a href="#使用多Buffer来改进" class="headerlink" title="使用多Buffer来改进"></a>使用多Buffer来改进</h2><p>上述两个缺点的根源是一致的：Framebuffer中的数据还没准备好整帧数据，就被LCD控制器使用了。</p>
<ul>
<li>使用双buffer甚至多buffer可以解决这个问题。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 假设有2个Framebuffer：FB0、FB1</span><br><span class="line">* LCD控制器正在读取FB0</span><br><span class="line">* APP写FB1</span><br><span class="line">* 写好FB1后，让LCD控制器切换到FB1</span><br><span class="line">* APP写FB0</span><br><span class="line">* 写好FB0后，让LCD控制器切换到FB0	</span><br></pre></td></tr></table></figure>

<p>具体流程：</p>
<p><img src="049_drv_app_use_double_buff.png"></p>
<ul>
<li>驱动：分配多个buffer</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fb_info-&gt;fix.smem_len = SZ_32M;</span><br><span class="line">fbi-&gt;screen_base = dma_alloc_writecombine(fbi-&gt;device, <span class="comment">//fbi-&gt;screen_base虚拟地址</span></span><br><span class="line">				fbi-&gt;fix.smem_len,</span><br><span class="line">				(<span class="keyword">dma_addr_t</span> *)&amp;fbi-&gt;fix.smem_start, <span class="comment">//fix.smem_start物理地址</span></span><br><span class="line">				GFP_DMA | GFP_KERNEL);</span><br></pre></td></tr></table></figure>

<ul>
<li>驱动：保存buffer信息</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fb_info-&gt;fix.smem_len  <span class="comment">// 含有总buffer大小 </span></span><br><span class="line">fb_info-&gt;var           <span class="comment">// 含有单个buffer信息</span></span><br></pre></td></tr></table></figure>

<p>fb_info固定信息 fix：显存起始地址，大小</p>
<p>可变信息 var：x / y 分辨率</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*一般情况下*/</span> <span class="comment">/*分配了多个buffer，在y轴上叠加*/</span></span><br><span class="line">yres_virtual = yres *n; xres_virtual = xres; </span><br><span class="line"><span class="comment">/* 但驱动程序一开始并不使能多buffer </span></span><br><span class="line"><span class="comment">*  即yres_virtual = yres；</span></span><br><span class="line"><span class="comment">*  需要 set : yres_virtual = yres *n;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>APP : 读取buffer信息</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ioctl(fd_fb, FBIOGET_FSCREENINFO, &amp;fix);</span><br><span class="line">ioctl(fd_fb, FBIOGET_VSCREENINFO, &amp;var);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算是否支持多buffer，有多少个buffer</span></span><br><span class="line">screen_size = var.xres * var.yres * var.bits_per_pixel / <span class="number">8</span>;</span><br><span class="line">nBuffers = fix.smem_len / screen_size;</span><br></pre></td></tr></table></figure>

<ul>
<li>APP：使能多buffer</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var.yres_virtual = nBuffers * var.yres;</span><br><span class="line">ioctl(fd_fb, FBIOPUT_VSCREENINFO, &amp;var);</span><br></pre></td></tr></table></figure>

<ul>
<li>APP : 写buffer</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fb_base = (<span class="keyword">unsigned</span> <span class="keyword">char</span> *)mmap(<span class="literal">NULL</span> , fix.smem_len, PROT_READ | PROT_WRITE, MAP_SHARED, fd_fb, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* get buffer */</span></span><br><span class="line">pNextBuffer =  fb_base + nNextBuffer * screen_size;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* set buffer */</span></span><br><span class="line">lcd_draw_screen(pNextBuffer, colors[i]);</span><br></pre></td></tr></table></figure>

<ul>
<li>APP : 切换buffer</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* switch buffer */</span></span><br><span class="line">var.yoffset = nNextBuffer * var.yres;</span><br><span class="line">ioctl(fd_fb, FBIOPAN_DISPLAY, &amp;var);</span><br></pre></td></tr></table></figure>

<ul>
<li>驱动：切换buffer</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// fbmem.c</span></span><br><span class="line"><span class="function">fb_ioctl</span></span><br><span class="line"><span class="function">    do_fb_ioctl</span></span><br><span class="line"><span class="function">    	<span class="title">fb_pan_display</span><span class="params">(info, &amp;var)</span></span>;</span><br><span class="line">			err = info-&gt;fbops-&gt;fb_pan_display(var, info) <span class="comment">// 调用硬件相关的函数   </span></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">huahui</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
